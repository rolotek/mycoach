---
phase: 08-projects
plan: 04
type: execute
wave: 2
depends_on: ["08-02"]
files_modified:
  - apps/web/src/app/(app)/projects (new or under app)
  - apps/web navigation (sidebar or nav link to Projects)
autonomous: true

must_haves:
  truths:
    - "User can see a list of their projects (name, status, due date) with link to detail"
    - "User can create a new project (name, description); edit name, description, status, due date"
    - "Project detail page shows definition (name, description, status, due), Documents & links section (attach existing document, add link with url+label), Milestones list (add/edit/delete), Tasks list (add/edit/delete, optional link to task thread)"
    - "Project detail has 'Open chat for this project' that opens chat with projectId so coach has context"
  artifacts:
    - path: "apps/web/src/app/(app)/projects/page.tsx"
      provides: "Projects list page"
    - path: "apps/web/src/app/(app)/projects/[id]/page.tsx"
      provides: "Project detail with definition, artifacts, milestones, tasks, Open chat button"
  key_links:
    - from: "apps/web projects pages"
      to: "trpc.project.*"
      via: "useQuery/useMutation"
      pattern: "trpc.project"
</must_haves>

<objective>
Build Projects UI: list page (all user projects), project detail page with Definition (name, description, status, due date), Documents & links (attach document from existing uploads, add external link with label), Milestones (list with add/edit/delete), Tasks (list with add/edit/delete and optional link to conversation). Include "Open chat for this project" that navigates to chat with projectId so the coach receives project context. Add Projects to app navigation (sidebar or nav).
</objective>

<context>
@.planning/phases/08-projects-user-defined-projects-e-g-improve-nda-templates-write-sci-fi-novel-onboarding-plan-with-definition-documents-artifacts-e-g-sharepoint-links-for-context-milestones-and-tasks/08-RESEARCH.md
@apps/server/src/trpc/router.ts (project procedures)
@apps/web (existing app shell, documents page for "attach document" pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Projects list page and navigation</name>
  <files>apps/web/src/app/(app)/projects/page.tsx, app layout or sidebar</files>
  <action>
1. Create route (e.g. apps/web/src/app/(app)/projects/page.tsx). Use trpc.project.list.useQuery() to fetch user's projects. Render as cards or table: name, status, due date, link to /projects/[id].

2. Add "New project" button that opens a form or modal (name, description); on submit call trpc.project.create.useMutation(), then invalidate list and navigate to new project detail.

3. Add "Projects" link to app navigation (sidebar or main nav) so user can reach /projects. Use existing design system (shadcn, layout).
</action>
</task>

<task type="auto">
  <name>Task 2: Project detail page — definition and artifacts</name>
  <files>apps/web/src/app/(app)/projects/[id]/page.tsx</files>
  <action>
1. Project detail page: trpc.project.get.useQuery({ id }) for single project with documents, links, milestones, tasks.

2. Definition section: show name, description, status, due date. Edit inline or form: trpc.project.update.useMutation() for name, description, status, dueDate.

3. Documents section: list attached documents (filename, link to existing documents page or download if applicable). "Attach document" button: open selector of user's existing documents (trpc document.list or similar); on select call project.addDocument.mutate({ projectId, documentId }). "Remove" per document calls project.removeDocument.

4. Links section: list links (label, url as clickable). "Add link" form: url + label; submit project.addLink. Remove: project.removeLink.
</action>
</task>

<task type="auto">
  <name>Task 3: Project detail — milestones and tasks</name>
  <files>apps/web/src/app/(app)/projects/[id]/page.tsx</files>
  <action>
1. Milestones section: list from project.get (milestones). Add milestone: form title, optional due date, sortOrder; project.createMilestone. Edit/delete: project.updateMilestone, project.deleteMilestone. Show title, due date, status if present.

2. Tasks section: list tasks (title, description, status, due date, link to conversation if conversationId set). Add task: project.createTask. Edit: project.updateTask (title, description, status, due date, conversationId). Delete: project.deleteTask. Optional: "Link to task thread" — if user has a task conversation, they can set conversationId on the task so the task row links to /chat/[conversationId].
</action>
</task>

<task type="auto">
  <name>Task 4: Open chat for this project</name>
  <files>apps/web/src/app/(app)/projects/[id]/page.tsx, chat page</files>
  <action>
1. On project detail page, add button "Open chat for this project". Navigate to /chat with projectId (e.g. /chat?projectId=xxx or store in session/local state). Chat page (from 08-03) reads projectId and includes it in message body so the coach receives project context.
</action>
</task>

</tasks>

<verification>
- User can create a project, attach a document and add a link, add milestones and tasks, open chat with project context. Project list and detail load without error; mutations update UI after invalidate.
</verification>
